WORK IN PROGRESS

Introduction:

xG (expected goals) is a metric used within football to describe the probability of shot converting into a goal. The development of the xG metric has been used in statistical scouting by both clubs and consultancies when trying to identify potential players for their teams. The following project seeks to experimentally build 4 xG models to identify potential scouting targets that Norwich City could have considered when they were required to replace Robbie Brady after his departure from the club. The 4 models were run through logistic regression, random forest classification, and xGboost classification.

Data Collection:

The project combines event data across the top 5 European League (taken from statsbomb) with player valuations and minutes played (taken from transfermarkt) during the 2015/16 season. In an ideal context we would also include tracking data alongside the event data, however this is not available in open formats for the 2015/16 season. Links to the data sources can be found at the bottom of this ReadMe.

Data Preparation + Feature Engineering:

The event data taken from statsbomb was imported through the statsbomb API and was subsequently cleaned and prepped for model use. This included all shots being grouped and separated into headers and non-headers. This was done to provide a basic segregation between two key finish types within a footballing context with different models being applied accordingly to better represent the differences between headers and non-headers and apply it to the dependent variable. Feature engineering was also extended to the IVs used to predict expected goals. This included the extraction/creation/grouping of the following variables:
Angle from shot to goal (CHECK)
Distance from shot to goal (CHECK)
Inverse Angle (CHECK)
Inverse Distance (CHECK)
Shot technique (CHECK)
First time finishes (0,1)
Assist type (CHECK)
Pattern of play (CHECK)
Shots under pressure (0,1)
Shots deflected (0,1)

In addition to the preparation of event data for modelling purposes, player valuation and minutes played data were included for player evaluation and normalisation purposes. Both player valuation and minutes played data were matched via player name to the statsbomb event data using a combination of the fuzzylogic library and manual mapping.

Metric Selections for the Model:

The idea behind the use of 4 differing model was to separate shooting actions and the factors that affect goal conversion into four categories. These categories are:
- Basic (Incl - Angle, Distance, Inverse, League)
- Singular Player Effects (Incl - Basic + technique, first time shot)
- Teammate Effects (Incl - Player Effects + assist type, pattern of play)
- Opposition Effects (Incl - Teammate + under pressure, shot deflected)

These categories seek to provide the differing effects generated by internal and external factors on the shots on the goal and apply them to the model accordingly.

Model Selection and Development:

As xG is the calculation of the probability of a binary outcome (a goal being scored or not), logistical regression, random forest classification, and xGboost classification were used to predict the xG of all shots within the event dataset. These models were initially run without tuning to determine which model naturally fit both headers and non-headers. Evaluations of these models were generated through cross-validated AUC, Brier, and RMSE scores as well as error and log loss plots.

After evaluation, the teammate effect random forest model was used to predict xG for headers and the opposition effect xGboost was used to predict xG for non-headers. Both of the models were tuned and regularised for optimisation and overfitting purposes. They produced the following evaluation scores:


Info about scores

Model Evaluation:


After predicting xG through the header and non-header models I ran a cross-comparison between my predicted xG and the statsbomb xG. This comparison was run using X. As expected, the statsbomb xG produced closer results to that of actual goals scored and as such was used when evaluating potential player signings. 

*More information can be found for the reasons as to which the statsbomb xG produced better results and further advancements that could be made to my models in the challenges and advancement section at the bottom of this readme.


Application of results to identify scouting prospects:

To identify potential replacements for Robbie Brady it was important to filter the players within the dataset by position and provide a close comparative analysis between Brady and the potential replacements. Furthermore, it was important to provide standardised metrics (per 90 stats) and scout realistic targets (players for a similar/lower value than Brady), which is where player valuation and minutes played data was used.

Once this filtering was applied, a number of scatter plots were produced to identify the exceptional performers in each metric based on the xG calculations. These included xG vs value, xA vs value and combined xG + xA vs value:

![Scatter plot for xG vs value](https://github.com/Jmann777/NCFC-Scouting-Project/assets/87671742/7e8e07f4-82c2-43f9-a16b-fa52286a75f2)

![xA Graph NCFC](https://github.com/Jmann777/NCFC-Scouting-Project/assets/87671742/267afb49-0073-4424-8d32-f4562af098c2)

![xGA Graph NCFC](https://github.com/Jmann777/NCFC-Scouting-Project/assets/87671742/55dc02b7-f15c-4bc4-b18c-8bcf1860ffc2)

As well as identifying high performance players it is also important to ensure that these players fit with the playing philosophy required to replace Brady. As this is an external project it is assumed that replacement performances must mirror the playstyle of Brady or at least closely compare. To identify this, player radars were created for Brady and similar top performing players. 


What did Brady's data profile look like?
![Robbie Brady Radar](https://github.com/Jmann777/NCFC-Scouting-Project/assets/87671742/30b804c7-32a1-4094-91d4-9e11f7227292)


Which players look similar/better?
![Filip Kostic Radar](https://github.com/Jmann777/NCFC-Scouting-Project/assets/87671742/9721d8e1-55ff-41ec-bf1e-9bda3f764a97)

![Jairo Samperio Radar](https://github.com/Jmann777/NCFC-Scouting-Project/assets/87671742/f66a3cc7-4ca3-4800-8ffe-a2f583d469de)

![Nicolas Benezet Radar](https://github.com/Jmann777/NCFC-Scouting-Project/assets/87671742/52f6f6bf-96ee-4d1f-8394-fef6187ded08)

From these radars we can see the player baring the closest resemblance to Brady is Filip Kostic. Kostic displays a high volume of shots, dribbles, key passes, and crosses which mirrors Brady. Accepting the differences in league standards, Kostic also shows a higher quality of finishing than Brady with his xG overperformance being a higher ranking. Of course, it is overly simplistic to assume that Kostic would be the correct fit for NCFC and vice versa, however from the data Kostic would have the potential to be a high value target for the club. 

Challenges + Improvements:
Lack of data (General data, tracking data). If there was more available data, we could train a more complex model (including tracking data) on a larger amount of data. 
Transfermarkt valuation data is market valuation estimates only. 
Lack of playing model for NCFC. As discussed, we would need to take playing + transfer philosophy into account when considering scouting prospects.


